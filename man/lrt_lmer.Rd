% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lrt_lmer.R
\name{lrt_lmer}
\alias{lrt_lmer}
\title{Likelihood Ratio Test for Linear Mixed-Effects Model}
\usage{
lrt_lmer(model, target, type, data, has_interaction = FALSE, verbose = TRUE)
}
\arguments{
\item{model}{A fitted model object from \code{\link[lme4:lmer]{lme4::lmer()}}. Currently not supporting formula
that contains shorthand \code{.}, such as \code{y ~ .}, or more than one random structure.}

\item{target}{A character value specifying the variable to be tested. Must match either
a fixed effect or a variable within a random effect structure.}

\item{type}{A character string indicating whether \code{target} is a \code{"fixed"} or \code{"random"} effect.}

\item{data}{A data frame used to fit \code{model}.}

\item{has_interaction}{A logical value, \code{TRUE} or \code{FALSE} (the default), indicating whether
\code{model} contains interaction between fixed effects. If \code{TRUE}, all terms containing \code{target}
will be removed to form the reduced model.}

\item{verbose}{A logical value, \code{TRUE} (the default) or \code{FALSE}, controlling whether detailed
test summary are printed to the console.}
}
\value{
A named list containing key test statistics:
\itemize{
\item \code{logLik}: Numeric. The log-likelihood difference between the full and reduced model.
\item \code{df}: Integer. The degrees of freedom difference between the two models, representing
the number of parameters removed.
\item \code{pvalue}: Numeric. The p-value from the Chi-square test.
}
}
\description{
Hypothesis testing on a selected fixed or random effect in a fitted lmer model using
the Likelihood Ratio Test. Currently only support models fitted with \code{\link[lme4:lmer]{lme4::lmer()}}
that contain fixed effects and a single random structure (i.e., no nested \code{/},
double vertical \code{||}, or multi-level random effects).
}
\section{Methods}{


The hypothesis test evaluates whether the selected effect provides meaningful variance
explanation in the linear mixed-effects model:
\itemize{
\item Null hypothesis H0: The selected variable has no valid effect (i.e., its coefficient
is 0 for fixed effects, or its variance component is 0 for random effects)
\item Alternative hypothesis H1: The selected variable significantly contributes
to model variability
}

To test this, the function removes the target variable, refits a suitable, reduced model
without it, and compares the fit of the full and reduced models using a Chi-square test
based on log-likelihood differences and calculated degrees of freedom (depending on
the target type).
}

\section{Reduced Model}{


The reduced model is constructed differently based on the type of effect being tested:
\itemize{
\item Fixed effect: The target fixed variable is removed from the original \code{lmer()} formula,
and the model is refitted.
\item Random intercept: The full model is reconstructed by modifying the original \code{lmer()} call
to retain only the random intercept (ignoring any random slopes). The reduced model is a
standard \code{lm()} model containing only the fixed effects, and the likelihood ratio test
follows a mixture chi-square distribution for p-value computation.
\item Random slope: The target variable is only removed from the random slope structure.
The reduced model remains an \code{lmer()} model, and the likelihood ratio test follows a mixture
chi-square distribution for p-value computation.
}

Any \code{lmer()} models fitted within this function, including the input model provided by the user,
will be refitted with \code{REML = FALSE} to ensure accurate hypothesis testing.
}

\examples{
library(lme4)
data(star)
model <- lmer(math ~ math_old + cltype + (cltype | school_id), data = star)

# Fixed effect testing
fix_result <- lrt_lmer(model, target = "math_old", type = "fixed", data = star)
fix_result
# Random effect testing
random_result1 <- lrt_lmer(model, target = "school_id", type = "random", data = star)
random_result2 <- lrt_lmer(model, target = "cltype", type = "random", data = star)

}
