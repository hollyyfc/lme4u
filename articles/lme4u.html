<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with lme4u • lme4u</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with lme4u">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lme4u</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/lme4u.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hollyyfc/lme4u/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting Started with lme4u</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hollyyfc/lme4u/blob/master/vignettes/lme4u.Rmd" class="external-link"><code>vignettes/lme4u.Rmd</code></a></small>
      <div class="d-none name"><code>lme4u.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hollyyfc/lme4u" class="external-link">lme4u</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="welcome-to-lme4u">Welcome to <code>lme4u</code><a class="anchor" aria-label="anchor" href="#welcome-to-lme4u"></a>
</h2>
<p>Hierarchical (or mixed-effects) models are essential tools for
analyzing data with grouped or nested structure — think students within
schools or patients within hospitals. And when it comes to fitting these
models in R, the <code>lme4</code> package is the go-to hub.</p>
<p>While <code>lme4</code> offers incredible modeling features, it can
also be hard to wrap your head around. Many users — especially those
transitioning from <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code> to <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer()</a></code>
or even <code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">lme4::glmer()</a></code> — find themselves overwhelmed by the
jump in complexity: random intercepts and slopes, link-scale estimates,
nested structures, and more. That’s where <code>lme4u</code> comes into
play.</p>
<p>Built directly on top of lme4, this package is designed to help you
<strong>interpret</strong>, <strong>diagnose</strong>, and
<strong>hypothesis-test</strong> your mixed models with clarity and
confidence. Whether you’re a student learning mixed models for the first
time or a researcher working with real-world grouped data,
<code>lme4u</code> walks you through the process with practical
explanations and inspiring tools.</p>
</div>
<div class="section level2">
<h2 id="example-context-students-in-schools">Example Context: Students in Schools<a class="anchor" aria-label="anchor" href="#example-context-students-in-schools"></a>
</h2>
<div class="section level3">
<h3 id="the-data">The Data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h3>
<p><code>lme4u</code> comes with a built-in dataset, <code>star</code>,
a cleaned subset of the well-known <a href="https://search.r-project.org/CRAN/refmans/AER/html/STAR.html" class="external-link"><em>Project
STAR</em></a> (student-teacher achievement ratio) data. The original
dataset follows students across elementary school years in Tennessee,
aiming to study the effect of class size on student test performance.
The processed version in <code>lme4u</code> focuses on student
performance in third grade, ensuring a hierarchical structure where
students are nested within schools.</p>
<p>The shape of <code>star</code> is 4192 * 13, which includes a subset
of key variables related to student demographics, prior-year (2nd grade)
and current-year (3rd grade) test scores, class assignment, teacher
qualifications, and school-level identifiers. All students in this
dataset have been controlled as attending the same school in both 2nd
and 3rd grades. To view details and data dictionary, run
<code><a href="../reference/star.html">?star</a></code> after loading <code>lme4u</code> into your
workspace.</p>
</div>
<div class="section level3">
<h3 id="the-model">The Model<a class="anchor" aria-label="anchor" href="#the-model"></a>
</h3>
<p>Under the context of <code>star</code>, suppose we’re intersted in
understanding:</p>
<blockquote>
<p><em>How does class type affect student math performance, after
accounting for prior achievements? And does this relationship vary
across schools?</em></p>
</blockquote>
<p>This type of question is common in education research, where students
are grouped within schools, and both individual- and group-level
heterogeneity contribute to outcomes. In R using <code>lme4</code>, this
would be implemented as:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">math</span> <span class="op">~</span> <span class="va">cltype</span> <span class="op">+</span> <span class="va">math_old</span> <span class="op">+</span> <span class="op">(</span><span class="va">cltype</span> <span class="op">|</span> <span class="va">school_id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">star</span><span class="op">)</span></span></code></pre></div>
<p>Of course, there could be other ways of modeling the relation. But we
will use this specific model to demonstrate how <code>lme4u</code> makes
interpretation and diagnostics easier throughout the vignette.</p>
</div>
</div>
<div class="section level2">
<h2 id="interpreting-the-model">Interpreting the Model<a class="anchor" aria-label="anchor" href="#interpreting-the-model"></a>
</h2>
<p>Immediately after the model fit, you might start wondering whether
the model structure is appropriate, or simply, what the formula means
statistically. A core component of the package,
<code><a href="../reference/explain_lmer.html">explain_lmer()</a></code>, provides structured, user-friendly
interpretations of linear mixed effects models fitted using
<code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer()</a></code>. This function is designed to bridge the gap
between raw model output and intuitive understanding, making it easier
for users to interpret their model structure and results.</p>
<div class="section level3">
<h3 id="general-summary">General Summary<a class="anchor" aria-label="anchor" href="#general-summary"></a>
</h3>
<p><code><a href="../reference/explain_lmer.html">explain_lmer()</a></code> supports three levels of interpretation
via the <code>details</code> argument. By default,
<code>"general"</code> will be run if no argument supplied to
<code>details</code>, which provides a high-level summary of the model,
describing its structure, fixed effects, and random effects in a concise
yet informative manner:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/explain_lmer.html">explain_lmer</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; This linear mixed-effects model examines how cltype, math_old affects math, while accounting for group-level variability across school_id.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The model adjusts for fixed effect(s), including cltype, math_old, which estimate the overall relationship with math across the entire dataset. For more detailed interpretations of fixed effects, use `details = "fixed"`.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The model includes the following random effects across grouping variables: cltype | school_id.</span></span>
<span><span class="co">#&gt;  *The random intercept(s), school_id, account for variations in the intercept across different groups, allowing each group to have its own baseline value that deviates from the overall average.</span></span>
<span><span class="co">#&gt;  *On top of the varying baselines, the model allows the effects of cltype on math to differ across their corresponding groups. This means that not only can each group start from a different baseline, but the strength and direction of the relationships between these variables and math can also vary from one group to another.</span></span>
<span><span class="co">#&gt; Check `details = 'random'` for more interpretation.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fixed-effects">Fixed Effects<a class="anchor" aria-label="anchor" href="#fixed-effects"></a>
</h3>
<p>If <code>"fixed"</code> is input, the function offers a detailed
explanation of the fixed effects, including interpretations of
individual estimates and their implications within the model
context:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/explain_lmer.html">explain_lmer</a></span><span class="op">(</span><span class="va">model</span>, details <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span>
<span><span class="co">#&gt; This model includes the following fixed effects: cltypesmall, cltyperegular+aide, math_old, along with the baseline estimate (Intercept).</span></span>
<span><span class="co">#&gt; Fixed effects estimate the average relationship between the predictors and the response variable `math` across all groups.</span></span>
<span><span class="co">#&gt; These effects reflect how changes in each predictor influence `math`, assuming all other variables are held constant and deviations from the baseline are measured accordingly.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To interpret the estimates:</span></span>
<span><span class="co">#&gt; - The &lt;Estimate&gt; represents the expected change in `math` for a one-unit change in the predictor. </span></span>
<span><span class="co">#&gt; - The &lt;Standard Error&gt; reflects uncertainty around the estimate.</span></span>
<span><span class="co">#&gt; - The &lt;t-value&gt; measures the significance of the effect relative to its variability.</span></span>
<span><span class="co">#&gt; - The &lt;Correlation&gt; provides insight into the relationships between fixed effect predictors.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For detailed interpretations of each fixed effect, use: `attr(, 'fixed_details')[['variable_name']]` to view specific results. You can find the list of available fixed effect variable names using: `attr(, 'fixed_names')` to guide your extraction.</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">fix</span>, <span class="st">"fixed_details"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`(Intercept)`</span></span>
<span><span class="co">#&gt; [1] "The intercept estimate suggests that when all predictors are set to zero, the expected value of `math` is approximately 201.646. This serves as the baseline for evaluating the effects of other variables in the model."</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cltypesmall</span></span>
<span><span class="co">#&gt; [1] "The fixed effect for 'cltypesmall' suggests that for a one-unit increase in 'cltypesmall', the expected change in `math` is approximately -0.434, assuming all other variables are held constant. This estimate has a standard error of 2.406 and a t-value of -0.18. To assess the overall impact of this effect, consider it relative to the model's baseline intercept."</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`cltyperegular+aide`</span></span>
<span><span class="co">#&gt; [1] "The fixed effect for 'cltyperegular+aide' suggests that for a one-unit increase in 'cltyperegular+aide', the expected change in `math` is approximately -0.117, assuming all other variables are held constant. This estimate has a standard error of 2.503 and a t-value of -0.047. To assess the overall impact of this effect, consider it relative to the model's baseline intercept."</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $math_old</span></span>
<span><span class="co">#&gt; [1] "The fixed effect for 'math_old' suggests that for a one-unit increase in 'math_old', the expected change in `math` is approximately 0.715, assuming all other variables are held constant. This estimate has a standard error of 0.01 and a t-value of 69.735. To assess the overall impact of this effect, consider it relative to the model's baseline intercept."</span></span></code></pre></div>
<p><strong>NOTE</strong>: If interaction is fitted to the model, the
function is also able to detect and adjust the interpretation.</p>
</div>
<div class="section level3">
<h3 id="random-effects">Random Effects<a class="anchor" aria-label="anchor" href="#random-effects"></a>
</h3>
<p>If <code>"random"</code> is input, the function focuses on random
effects, explaining random intercepts, slopes, and variance components
to highlight across-group variability:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/explain_lmer.html">explain_lmer</a></span><span class="op">(</span><span class="va">model</span>, details <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span>
<span><span class="co">#&gt; There is 1 random term you fit in the model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; cltype | school_id: Your model assumes there is across-group heterogeneity in the baseline level of math across school_id (random intercepts), allowing each group to have its own starting point that deviates from the overall average. Additionally, the effects of cltype on math are allowed to vary within each school_id (random slopes), capturing differences in these relationships across groups.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To explore variance contributions based on the model estimates, use: `attr(, 'var_details')`.</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">random</span>, <span class="st">"var_details"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $high_var</span></span>
<span><span class="co">#&gt; [1] "The following terms explain a substantial proportion of the variance: Residual. This suggests that these random effects contribute meaningfully to capturing group-level heterogeneity. Note: The residual variance dominates, suggesting that within-group heterogeneity explains most of the variation. This could indicate a weak random effect structure."</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $low_var</span></span>
<span><span class="co">#&gt; [1] "The following terms explain a relatively small portion of the variance: NA, school_id - (Intercept). You might reconsider including these terms in your random effect structure if their contributions are negligible."</span></span></code></pre></div>
<p><strong>NOTE</strong>: The random part is also capable of detecting
nested grouping structure, uncorrelated random effects, and multi-level
random structures. However, use the interpretation deliberately under
such complex cases.</p>
</div>
</div>
<div class="section level2">
<h2 id="assumption-diagnostics">Assumption Diagnostics<a class="anchor" aria-label="anchor" href="#assumption-diagnostics"></a>
</h2>
<p>(TBD)</p>
</div>
<div class="section level2">
<h2 id="testing-effects">Testing Effects<a class="anchor" aria-label="anchor" href="#testing-effects"></a>
</h2>
<p>Once you’ve interpreted your model and checked that assumptions
reasonably hold, the next natural step is to test whether certain
effects — fixed or random — meaningfully contribute to your model.
<code><a href="../reference/lrt_lmer.html">lrt_lmer()</a></code> provides likelihood ratio tests on a selected
fixed or random effect in a fitted <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer()</a></code> model. It
aims to gauge the effect brought in by one single term and apply
statistically accurate null distribution based on different effect
types.</p>
<p>Depending on whether you’re testing a fixed effect or a random effect
by the <code>type</code> argument, the structure of the reduced model
differs. Currently, the function only supports lmer models with fixed
effects and a <strong>single</strong> random structure (i.e., no nested
<code>/</code>, double vertical <code>||</code>, or multi-level random
effects). To see more about the testing logic and how the reduced models
are constructed differently, run <code><a href="../reference/lrt_lmer.html">?lrt_lmer</a></code>.</p>
<div class="section level3">
<h3 id="fixed-effects-1">Fixed Effects<a class="anchor" aria-label="anchor" href="#fixed-effects-1"></a>
</h3>
<p>To test whether a selected fixed effect exists, specify the exact
variable name in <code>target</code> and set
<code>type = "fixed"</code>. This will allow the function to match with
the underlying set of fixed terms. Running the function will give a
summary of output, along with the test statistics being returned as a
list:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fix_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lrt_lmer.html">lrt_lmer</a></span><span class="op">(</span><span class="va">model</span>, target <span class="op">=</span> <span class="st">"math_old"</span>, type <span class="op">=</span> <span class="st">"fixed"</span>, data <span class="op">=</span> <span class="va">star</span><span class="op">)</span></span>
<span><span class="co">#&gt; Likelihood Ratio Test for 'math_old' (fixed effect)</span></span>
<span><span class="co">#&gt; Full Model: math ~ cltype + math_old + (cltype | school_id)</span></span>
<span><span class="co">#&gt; Reduced Model: math ~ cltype + (cltype | school_id)</span></span>
<span><span class="co">#&gt; Test Statistics:</span></span>
<span><span class="co">#&gt; - Log-Likelihood Difference: 3202.807</span></span>
<span><span class="co">#&gt; - Degrees of Freedom: 1 (Difference in estimated parameters)</span></span>
<span><span class="co">#&gt; - P-Value: &lt; 2.2e-16 (Chi-square test)</span></span>
<span><span class="co">#&gt; Since p = &lt; 2.2e-16, under alpha level of 0.05, we reject the null hypothesis. The test suggests that the fixed effect of math_old is statistically significant and contributes to the model.</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fix_result</span></span>
<span><span class="co">#&gt; $logLik</span></span>
<span><span class="co">#&gt; [1] 3202.807</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pvalue</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p><strong>NOTE</strong>: If interaction is fitted to the model, specify
<code>has_interaction = TRUE</code> in the input argument. The reduced
model will be subsequently constructed without the selected fixed effect
and any interaction terms containing it.</p>
</div>
<div class="section level3">
<h3 id="random-effects-1">Random Effects<a class="anchor" aria-label="anchor" href="#random-effects-1"></a>
</h3>
<p>To test the excess heterogeneity contributed by a random effect term,
specify the exact variable name in <code>target</code> and set
<code>type = "random"</code>. Then, the function will check whether the
target is a random intercept (grouping variable) or a random slope in
the model, and apply corresponding computation for the likelihood ratio
test.</p>
<p><strong><em>Random Intercept</em></strong>: The full model is
reconstructed by modifying the original <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer()</a></code> call
to retain only the random intercept (ignoring any random slopes). The
reduced model is a standard <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code> model containing
only the fixed effects, and the likelihood ratio test follows a mixture
Chi-square distribution for p-value computation.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random_result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lrt_lmer.html">lrt_lmer</a></span><span class="op">(</span><span class="va">model</span>, target <span class="op">=</span> <span class="st">"school_id"</span>, type <span class="op">=</span> <span class="st">"random"</span>, data <span class="op">=</span> <span class="va">star</span><span class="op">)</span></span>
<span><span class="co">#&gt; Likelihood Ratio Test for 'school_id' (random intercept effect)</span></span>
<span><span class="co">#&gt; Full Model: math ~ cltype + math_old + (1 | school_id)</span></span>
<span><span class="co">#&gt; Reduced Model: math ~ cltype + math_old</span></span>
<span><span class="co">#&gt; Test Statistics:</span></span>
<span><span class="co">#&gt; - Log-Likelihood Difference: 603.7954</span></span>
<span><span class="co">#&gt; - Degrees of Freedom: 1 (Difference in estimated parameters)</span></span>
<span><span class="co">#&gt; - P-Value: &lt; 2.2e-16 (Chi-square test)</span></span>
<span><span class="co">#&gt; Since p = &lt; 2.2e-16, under alpha level of 0.05, we reject the null hypothesis. The test suggests that the random intercept effect of school_id is statistically significant and contributes to the model.</span></span></code></pre></div>
<p><strong><em>Random Slope</em></strong>: The target variable is only
removed from the random slope structure. The reduced model remains an
<code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer()</a></code> model, and the likelihood ratio test follows a
mixture Chi-square distribution for p-value computation.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random_result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lrt_lmer.html">lrt_lmer</a></span><span class="op">(</span><span class="va">model</span>, target <span class="op">=</span> <span class="st">"cltype"</span>, type <span class="op">=</span> <span class="st">"random"</span>, data <span class="op">=</span> <span class="va">star</span><span class="op">)</span></span>
<span><span class="co">#&gt; Likelihood Ratio Test for 'cltype' (random slope effect)</span></span>
<span><span class="co">#&gt; Full Model: math ~ cltype + math_old + (cltype | school_id)</span></span>
<span><span class="co">#&gt; Reduced Model: math ~ cltype + math_old + (1 | school_id)</span></span>
<span><span class="co">#&gt; Test Statistics:</span></span>
<span><span class="co">#&gt; - Log-Likelihood Difference: 326.1249</span></span>
<span><span class="co">#&gt; - Degrees of Freedom: 5 (Difference in estimated parameters)</span></span>
<span><span class="co">#&gt; - P-Value: &lt; 2.2e-16 (Chi-square test)</span></span>
<span><span class="co">#&gt; Since p = &lt; 2.2e-16, under alpha level of 0.05, we reject the null hypothesis. The test suggests that the random slope effect of cltype is statistically significant and contributes to the model.</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Holly Cui.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
